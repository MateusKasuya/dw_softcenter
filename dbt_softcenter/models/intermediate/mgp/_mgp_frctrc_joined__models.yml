version: 2  # Versão do esquema de metadados

models:
  - name: int_mgp_frctrc_joined # Nome do modelo
    description: >
      View Intermediate da FRCTRC join com TBFIL, TBCLI, TBCID, FACTRC
    columns:
          - name: nroctrc
            description: Número CTRC - Primary Key Composta

          - name: ufctrc
            description: UF CTRC - Primary Key Composta

          - name: dataemissao
            description: Data emissão CTE

          - name: situacao
            description: Situação em que se encontra o CTRC

          - name: tipo_cte
            description: Tipo de CT-e - Classificação do  tipo do  CT-e

          - name: filial
            description: Nome Filial Emitente

          - name: cgccpfdestina
            description: CPF/CNPJ Cliente

          - name: cliente
            description: Nome Cliente

          - name: cidade
            description: Cidade Destino de Entrega

          - name: mesorregiao
            description: Mesorregião do Município

          - name: coduf
            description: UF do Município

          - name: regiao
            description: Região do Município

          - name: cidade_uf
            description: Concatenado de Cidade e UF

          - name: localizacao_pbi
            description: Concatenado para usar no Mapa Power BI

          - name: produto
            description: Produto transportado

          - name: pesofrete_ton
            description: Peso do frete em toneladas

          - name: vlrtotfrete
            description: Valor do frete

          - name: vlrpedagio
            description: Valor do Pedágio

          - name: vlrimposto
            description: Valor do Imposto

          - name: datavencto
            description: Data Vencimento da Fatura

          - name: datarecbto
            description: Data de Recebimento da Fatura

          - name: dias_recebimento
            description: Dias desde a emissão do CTE até o pagamento

          - name: vlrfatura
            description: Valor da fatura

          - name: vlrrecbto
            description: Valor de recebimento da fatura

          - name: vlrsaldo
            description: Valor de saldo da fatura

          - name: condicao_fatura
            description: Condição em que a fatura se encontra - Ag. Fatura ou A Receber ou Em Atraso ou Recebida

          - name: datatlz
            description: Data de atualização do registro
            tests:
              - not_null
